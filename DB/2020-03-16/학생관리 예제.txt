-- 테이블 순서는 관계를 고려하여 한 번에 실행해도 에러가 발생하지 않게 정렬되었습니다.

-- STUDENT Table Create SQL
CREATE TABLE STUDENT
(
    STU_NO    NUMBER           NOT NULL, 
    NAME      VARCHAR2(20)     NOT NULL, 
    AGE       NUMBER           NOT NULL, 
    GENDER    CHAR(3)          NULL, 
    PHONE     CHAR(13)         NULL, 
    ADDR      VARCHAR2(500)    NOT NULL, 
    CONSTRAINT STUDENT_PK PRIMARY KEY (STU_NO)
)
/

CREATE SEQUENCE STUDENT_SEQ
START WITH 1
INCREMENT BY 1;
/

CREATE OR REPLACE TRIGGER STUDENT_AI_TRG
BEFORE INSERT ON STUDENT 
REFERENCING NEW AS NEW FOR EACH ROW 
BEGIN 
    SELECT STUDENT_SEQ.NEXTVAL
    INTO :NEW.STU_NO
    FROM DUAL;
END;
/

--DROP TRIGGER STUDENT_AI_TRG;
/

--DROP SEQUENCE STUDENT_SEQ;
/

COMMENT ON TABLE STUDENT IS '학생테이블'
/

COMMENT ON COLUMN STUDENT.STU_NO IS '학생번호'
/

COMMENT ON COLUMN STUDENT.NAME IS '이름'
/

COMMENT ON COLUMN STUDENT.AGE IS '나이'
/

COMMENT ON COLUMN STUDENT.GENDER IS '성별'
/

COMMENT ON COLUMN STUDENT.PHONE IS '전화번호'
/

COMMENT ON COLUMN STUDENT.ADDR IS '주소'
/


-- STUDENT Table Create SQL
CREATE TABLE BOARD
(
    BOARD_NO         NUMBER            NOT NULL, 
    BOARD_TITLE      VARCHAR2(300)     NULL, 
    BOARD_CONTENT    VARCHAR2(3000)    NULL, 
    BOARD_WRITER     NUMBER            NULL, 
    WIRTE_DATE       DATE              NULL, 
    CONSTRAINT BOARD_PK PRIMARY KEY (BOARD_NO)
)
/

CREATE SEQUENCE BOARD_SEQ
START WITH 1
INCREMENT BY 1;
/

CREATE OR REPLACE TRIGGER BOARD_AI_TRG
BEFORE INSERT ON BOARD 
REFERENCING NEW AS NEW FOR EACH ROW 
BEGIN 
    SELECT BOARD_SEQ.NEXTVAL
    INTO :NEW.BOARD_NO
    FROM DUAL;
END;
/

--DROP TRIGGER BOARD_AI_TRG;
/

--DROP SEQUENCE BOARD_SEQ;
/

COMMENT ON TABLE BOARD IS '게시판'
/

COMMENT ON COLUMN BOARD.BOARD_NO IS '게시물 번호'
/

COMMENT ON COLUMN BOARD.BOARD_TITLE IS '게시물 제목'
/

COMMENT ON COLUMN BOARD.BOARD_CONTENT IS '게시물 내용'
/

COMMENT ON COLUMN BOARD.BOARD_WRITER IS '게시물 작성자'
/

COMMENT ON COLUMN BOARD.WIRTE_DATE IS '작성일'
/

ALTER TABLE BOARD
    ADD CONSTRAINT FK_BOARD_BOARD_WRITER_STUDENT_ FOREIGN KEY (BOARD_WRITER)
        REFERENCES STUDENT (STU_NO)
/


